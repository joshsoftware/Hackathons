var KeyTable;!function(e,t,n){var o=function(o,f){"use strict";return KeyTable=function(f){function l(e){return function(t,n,o){if(null!==t&&"number"!=typeof t||null!==n&&"number"!=typeof n||"function"!=typeof o){if("object"==typeof t&&"function"==typeof n){var f=m(t);r(e,f[0],f[1],n)}}else r(e,t,n,o)}}function a(e){return function(t,n,o){if(null!==t&&"number"!=typeof arguments[0]||null!==n&&"number"!=typeof arguments[1]){if("object"==typeof arguments[0]){var f=m(t);"function"==typeof arguments[1]?i(e,f[0],f[1],n):i(e,f[0],f[1])}}else"function"==typeof arguments[2]?i(e,t,n,o):i(e,t,n)}}function r(e,t,n,o){B[e].push({x:t,y:n,fn:o})}function i(e,t,n,o){for(var f=0,l=0,a=B[e].length;l<a-f;l++)if("undefined"!=typeof o)B[e][l-f].x==t&&B[e][l-f].y==n&&B[e][l-f].fn==o&&(B[e].splice(l-f,1),f++);else if(B[e][l-f].x==t&&B[e][l-f].y==n)return B[e].splice(l,1),1;return f}function s(e,t,n){for(var o=0,f=B[e],l=0;l<f.length;l++)(f[l].x==t&&f[l].y==n||null===f[l].x&&f[l].y==n||f[l].x==t&&null===f[l].y||null===f[l].x&&null===f[l].y)&&(f[l].fn(h(t,n),t,n),o++);return o}function u(n,f){if(_!=n){"undefined"==typeof f&&(f=!0),null!==_&&d(_),o(n).addClass(j),o(n).parent().addClass(j);var l;if(P){l=P;for(var a=N(n)[1],r=w;a>=l.fnDisplayEnd();)l._iDisplayLength>=0?l._iDisplayStart+l._iDisplayLength<l.fnRecordsDisplay()&&(l._iDisplayStart+=l._iDisplayLength):l._iDisplayStart=0,P.oApi._fnCalculateEnd(l);for(;a<l._iDisplayStart;)l._iDisplayStart=l._iDisplayLength>=0?l._iDisplayStart-l._iDisplayLength:0,l._iDisplayStart<0&&(l._iDisplayStart=0),P.oApi._fnCalculateEnd(l);P.oApi._fnDraw(l),w=r}var i=m(n);_=n,C=i[0],K=i[1];var u,c,p,y,T,h,S;if(f&&(u=o(e).height(),c=o(e).width(),p=o(t).scrollTop(),y=o(t).scrollLeft(),T=n.offsetHeight,h=n.offsetWidth,S=D(n),!P||"undefined"==typeof l.oScroll||""===l.oScroll.sX&&""===l.oScroll.sY||(S[1]-=o(l.nTable.parentNode).scrollTop(),S[0]-=o(l.nTable.parentNode).scrollLeft()),S[1]+T>p+u?v(S[1]+T-u):S[1]<p&&v(S[1]),S[0]+h>y+c?g(S[0]+h-c):S[0]<y&&g(S[0])),P&&"undefined"!=typeof l.oScroll&&(""!==l.oScroll.sX||""!==l.oScroll.sY)){var L=l.nTable.parentNode;u=L.clientHeight,c=L.clientWidth,p=L.scrollTop,y=L.scrollLeft,T=n.offsetHeight,h=n.offsetWidth,n.offsetTop+T>u+p?L.scrollTop=n.offsetTop+T-u:n.offsetTop<p&&(L.scrollTop=n.offsetTop),n.offsetLeft+h>c+y?L.scrollLeft=n.offsetLeft+h-c:n.offsetLeft<y&&(L.scrollLeft=n.offsetLeft)}b(),s("focus",C,K)}}function c(){d(_),C=null,K=null,_=null,T()}function d(e){o(e).removeClass(j),o(e).parent().removeClass(j),s("blur",C,K)}function p(e){for(var t=this;"TD"!=t.nodeName;)t=t.parentNode;u(t),b()}function y(e){if(E.block||!w)return!0;if(e.metaKey||e.altKey||e.ctrlKey)return!0;var t,n,o,f=x.getElementsByTagName("tr")[0].getElementsByTagName("td").length;if(P){o=P.aiDisplay.length;var l=N(_);if(null===l)return;C=l[0],K=l[1]}else o=x.getElementsByTagName("tr").length;var a=9==e.keyCode&&e.shiftKey?-1:e.keyCode;switch(a){case 13:return e.preventDefault(),e.stopPropagation(),s("action",C,K),!0;case 27:if(!s("esc",C,K))return void c();t=C,n=K;break;case-1:case 37:if(C>0)t=C-1,n=K;else{if(!(K>0))return!(a!=-1||!L)&&(q=!0,k.focus(),setTimeout(function(){q=!1},0),w=!1,c(),!0);t=f-1,n=K-1}break;case 38:if(!(K>0))return!1;t=C,n=K-1;break;case 36:t=C,n=0;break;case 33:t=C,n=K-10,n<0&&(n=0);break;case 9:case 39:if(C<f-1)t=C+1,n=K;else{if(!(K<o-1))return!(9!=a||!L)&&(q=!0,k.focus(),setTimeout(function(){q=!1},0),w=!1,c(),!0);t=0,n=K+1}break;case 40:if(!(K<o-1))return!1;t=C,n=K+1;break;case 35:t=C,n=o-1;break;case 34:t=C,n=K+10,n>o-1&&(n=o-1);break;default:return!0}return u(h(t,n)),!1}function b(){w||(w=!0)}function T(){w=!1}function h(e,t){return P?"undefined"!=typeof P.aoData[P.aiDisplay[t]]?P.aoData[P.aiDisplay[t]].nTr.getElementsByTagName("td")[e]:null:o("tr:eq("+t+")>td:eq("+e+")",x)[0]}function m(e){return P?[o("td",e.parentNode).index(e),o("tr",e.parentNode.parentNode).index(e.parentNode)+P._iDisplayStart]:[o("td",e.parentNode).index(e),o("tr",e.parentNode.parentNode).index(e.parentNode)]}function v(e){t.documentElement.scrollTop=e,t.body.scrollTop=e}function g(e){t.documentElement.scrollLeft=e,t.body.scrollLeft=e}function D(e){var t=0,n=0;if(e.offsetParent)for(t=e.offsetLeft,n=e.offsetTop,e=e.offsetParent;e;)t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;return[t,n]}function N(e){for(var t=0,n=P.aiDisplay.length;t<n;t++)for(var o=P.aoData[P.aiDisplay[t]].nTr,f=o.getElementsByTagName("td"),l=0,a=f.length;l<a;l++)if(f[l]==e)return[l,t];return null}function S(e,n,f,l){if(E=l,"undefined"==typeof f&&(f={}),"undefined"==typeof f.focus&&(f.focus=[0,0]),f.table=e,o(f.table).addClass("KeyTable"),"undefined"!=typeof f.focusClass&&(j=f.focusClass),"undefined"!=typeof n&&(P=n),"undefined"==typeof f.initScroll&&(f.initScroll=!0),"undefined"==typeof f.form&&(f.form=!1),L=f.form,x=f.table.getElementsByTagName("tbody")[0],L){var a=t.createElement("div");k=t.createElement("input"),a.style.height="1px",a.style.width="0px",a.style.overflow="hidden","undefined"!=typeof f.tabIndex&&(k.tabIndex=f.tabIndex),a.appendChild(k),f.table.parentNode.insertBefore(a,f.table.nextSibling),o(k).focus(function(){q||(w=!0,q=!1,"undefined"!=typeof f.focus.nodeName?u(f.focus,f.initScroll):u(h(f.focus[0],f.focus[1]),f.initScroll),setTimeout(function(){k.blur()},0))}),w=!1}else"undefined"!=typeof f.focus.nodeName?u(f.focus,f.initScroll):u(h(f.focus[0],f.focus[1]),f.initScroll),b();o(t).bind("keydown",y),P?o(P.nTable).on("click","td",p):o(x).on("click","td",p),o(t).click(function(e){for(var t=e.target,n=!1;t;){if(t==f.table){n=!0;break}t=t.parentNode}n||c()})}this.block=!1,this.event={remove:{}},this.fnGetCurrentPosition=function(){return[C,K]},this.fnGetCurrentData=function(){return _.innerHTML},this.fnGetCurrentTD=function(){return _},this.fnSetPosition=function(e,t){u("object"==typeof e&&e.nodeName?e:h(e,t))},this.fnBlur=function(){c()};var L,k,x=null,_=null,C=null,K=null,E=null,j="focus",w=!1,B={action:[],esc:[],focus:[],blur:[]},P=null,q=!1;for(var A in B)A&&(this.event[A]=l(A),this.event.remove[A]=a(A));var H,Q;f===n?(H=o("table.KeyTable")[0],Q=null):o.isPlainObject(f)?(H=f.table,Q=f.datatable):(Q=new o.fn.dataTable.Api(f).settings()[0],H=Q.nTable),S(H,Q,f,this)},KeyTable.version="1.2.1",o.fn.dataTable.KeyTable=KeyTable,o.fn.DataTable.KeyTable=KeyTable,KeyTable};"function"==typeof define&&define.amd?define(["jquery","datatables"],o):"object"==typeof exports?o(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.KeyTable&&o(jQuery,jQuery.fn.dataTable)}(window,document);